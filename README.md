# Todos APP ~~with Firebase~~

## ğŸ’¡ í”„ë¡œì íŠ¸ ì •ë³´

1. í”„ë¡œì íŠ¸ ëª… : Todos App ~~with Firebase~~
2. í”„ë¡œì íŠ¸ ê¸°ê°„ : 2022. 9. 12. ~ 2022. 9. 19.
3. í”„ë¡œì íŠ¸ ì°¸ê°€ ì¸ì›: ë‹¨ë…í”„ë¡œì íŠ¸

<br />

---

<br/>

## ğŸŒˆ ì‹¤í–‰ ë°©ë²•

    $ git clone https://github.com/hjpark625/new-todos.git
    $ cd new-todos
    $ yarn install
    $ yarn start

<br />

---

## ~~â­ ë°°í¬ ë§í¬~~

<br/>

> ~~http://new-todos.vercel.app/~~  
> ìì²´ ê°œë°œí•œ ì„œë²„ ì‚¬ìš©ìœ¼ë¡œ ì¸í•œ ë°°í¬ ì¤‘ë‹¨

<br/>

---

## ğŸ” í…ŒìŠ¤íŠ¸ ê³„ì •

<br />

> id(email): jeff@naver.com  
> password: 1q2w3e4r!

<br/>

---

## ğŸ“š ì‚¬ìš© ê¸°ìˆ  ìŠ¤íƒ

<br />

![react](https://img.shields.io/badge/react-18.2.0-61DAFB?logo=react)
![typescript](https://img.shields.io/badge/typescript-4.8.3-3178C6?logo=typescript)
![styledComponents](https://img.shields.io/badge/styled--components-5.3.5-DB7093?logo=styledcomponents)
![react-router-dom](https://img.shields.io/badge/react--router--dom-6.3.0-blue?logo=react-router)  
![redux](https://img.shields.io/badge/redux--toolkit-1.9.1-pink?logo=redux)
![react-redux](https://img.shields.io/badge/react--redux-8.0.2-pink?logo=redux)
![redux-saga](https://img.shields.io/badge/react--saga-1.2.3-pink?logo=redux-saga)

- **ì„ ì • ì´ìœ **

  - *TypeScript*
    - ì •ì  íƒ€ì… ì§€ì›í•˜ë¯€ë¡œ ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ë¥¼ ì‚¬ì „ì— í¬ì°©í•  ìˆ˜ ìˆìœ¼ë©° ì´ë¥¼ í†µí•´ ë¯¸ë¦¬ ë””ë²„ê¹…ì´ ê°€ëŠ¥í•¨
  - *Styled-Components*
    - CSS-in-JSëŠ” ì§§ì€ ê¸¸ì´ì˜ ìœ ë‹ˆí¬í•œ í´ë˜ìŠ¤ë¥¼ ìë™ì ìœ¼ë¡œ ìƒì„±í•˜ê¸°ì— ì½”ë“œ ê²½ëŸ‰í™”ì— íš¨ê³¼ì 
    - ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ ê°œë°œ ë°©ë²•ì— ì í•©í•˜ê³  ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” CSS-in-JS ë¼ì´ë¸ŒëŸ¬ë¦¬
    - JS ìƒìˆ˜ì™€ í•¨ìˆ˜ë¥¼ ì‰½ê²Œ ê³µìœ í•˜ì—¬ propsë¥¼ í™œìš©í•œ ì¡°ê±´ë¶€ ë Œë”ë§ì— ìš©ì´
    - ì»´í¬ë„ŒíŠ¸í™”í•˜ì—¬ ì¬í™œìš© ê°€ëŠ¥
  - ~~*Firebase*~~(23. 4. 16(ì¼)ë¶€ ìì²´ ê°œë°œ ì„œë²„ë¡œ ì „í™˜)
    - ~~ë°±ì—”ë“œì˜ ë¶€ì¬ë¡œ ì¸í•œ Todoë¦¬ìŠ¤íŠ¸ë¥¼ ì €ì¥í•  ë°ì´í„° êµ¬ì¶•ì— í™œìš©~~
    - ~~email, passwordë¡œê·¸ì¸ APIë¥¼ ì§€ì›~~
    - ~~DBë¥¼ ìì²´ì ìœ¼ë¡œ ë˜í•œ ììœ ë¡­ê²Œ êµ¬ì¶•í•  ìˆ˜ ìˆì–´ ê°œì¸ í”„ë¡œì íŠ¸ì— í™œìš©í•˜ê¸°ì— ìš©ì´~~
  - *React-Router-Dom*
    - Reactì˜ SPA(Single Page Application)íŠ¹ì„±ìƒ í•˜ë‚˜ì˜ í˜ì´ì§€(HTML)ì—ì„œ ëª¨ë“  ë Œë”ë§ì´ ì´ë£¨ì–´ì§
    - Reactì˜ ì´ëŸ¬í•œ ê°•ì ì„ í™œìš©í•˜ê¸° ìœ„í•´ í˜ì´ì§€ì˜ ë¡œë”©ì—†ì´ í˜ì´ì§€ì— í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§ í•˜ê¸° ìœ„í•´ ì‚¬ìš©
  - *Redux* / *React-Redux*
    - ì „ì—­ ìƒíƒœ ê´€ë¦¬í•˜ëŠ”ë° í™œìš©
    - ì „ì—­ ìƒíƒœ ê´€ë¦¬ì— ìˆì–´ props drillingì„ í”¼í•  ìˆ˜ ìˆìŒê³¼ ë™ì‹œì— ì„±ëŠ¥ ìµœì í™”ì— ìš©ì´
  - *Redux-Saga*
    - ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ, TODO CRUD ë“± ê°ì¢… ë¹„ë™ê¸° ì²˜ë¦¬(middleware)ë¥¼ ìœ„í•´ ì‚¬ìš©

<br />

---

## ğŸ“ í´ë” êµ¬ì¡°

    root
    |-- tsconfig.json
    |-- README.md
    |-- package.json
    |-- yarn.lock
    |-- .gitignore
    |-- public
    |   |-- index.html
    |-- src
        |-- compoenents
           |-- auth
               |-- styles
           |-- Todos
           |-- types
        |-- pages
           |-- Main
           |-- Todo
        |-- modules
        |-- styles
        |-- Router.tsx
        |-- index.tsx
        |-- react-app-env.d.ts
        |-- firebase.ts

---

## ğŸ“ êµ¬í˜„ ê¸°ëŠ¥

### ë¡œê·¸ì¸ ë° íšŒì›ê°€ì…

- ë¡œê·¸ì¸ ë° íšŒì›ê°€ì…í•  ë•Œ sagaë¥¼ ì œì‘í•´ì„œ ì ìš©í–ˆë‹¤.
- authì— ê´€ë ¨ëœ sagaë“¤ì€ ë¡œê·¸ì¸ê³¼ ê±°ì˜ ë™ì¼í•˜ê²Œ ì‘ì—…í–ˆë‹¤.
  ```typescript
  function* loginSaga(
    action: PayloadAction<{ email: string; password: string }>
  ):
    | Generator<CallEffect<AxiosResponse<AuthResponseType, any>>>
    | PutEffect<{ payload: undefined; type: 'auth/LOGIN_SUCCESS' }> {
    yield put(startLoading(LOGIN));
    try {
      const res = yield call(authAPI.login, action.payload);
      localStorage.setItem('access_token', res.user.access_token);
      alert(`ì–´ì„œì˜¤ì„¸ìš” ${res.user.info.username}ë‹˜!`);
      yield put(loginSuccess(res));
    } catch (e: unknown) {
      if (isAxiosError<AuthErrorType>(e)) {
        const data = e.response?.data || { message: 'ì•Œ ìˆ˜ ì—†ëŠ” ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' };
        alert(data.message);
        yield put(loginFailure(data));
      }
    } finally {
      yield put(finishLoading(LOGIN));
    }
  }
  ```
  - `login`ì´ë¼ëŠ” actionì„ dispatchí•´ì„œ loginSagaê°€ ì‹¤í–‰ë˜ë©´ `put`ì´ë¼ëŠ” effectí†µí•´ `startLoading`ì´ë¼ëŠ” actionì„ dispatchí•œë‹¤.
  - ê·¸ë¦¬ê³  `call`ì´ë¼ëŠ” effectë¥¼ í†µí•´ login apië¥¼ í˜¸ì¶œí•˜ê³  ê·¸ return ê°’ì„ resì— ë‹´ì•„ì£¼ê³  sagaì˜ ì´ë²¤íŠ¸ê°€ ì•„ë‹Œ ì¼ë°˜ ì•¡ì…˜ë“¤ì„ ì‹¤í–‰í•œë‹¤.(ë¡œì»¬ ìŠ¤í† ë¦¬ì§€, welcome alert ë“±)
  - `put` effectë¥¼ í†µí•´ì„œ ë¡œê·¸ì¸ì´ ì„±ê³µëì„ ë•Œì˜ actionì„ dispatchí•œë‹¤. ì´ë•Œ apiì˜ returnê°’ì¸ resë¥¼ payloadë¡œ ë„£ì–´ì¤€ë‹¤.
  - ë§Œì•½ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤ë©´ `isAxiosError`ë¼ëŠ” axiosì—ì„œ ì œê³µí•´ì£¼ëŠ” í•¨ìˆ˜ë¥¼ í†µí•´ ì—ëŸ¬ ê°ì²´ì˜ íƒ€ì…ì„ í™•ì‹¤í•˜ê²Œ ì§€ì •í•˜ê³  ê·¸ ì—ëŸ¬ ê°ì²´ì˜ responseê°’ì„ dataì— ë‹´ì•„ì¤€ë‹¤.
  - ì„œë²„ì—ì„œ ì •í•´ë‘” error ë©”ì„¸ì§€ë¥¼ alertë¥¼ í†µí•´ ë„ì›Œì£¼ê³  `put` effectë¥¼ í†µí•´ ë¡œê·¸ì¸ì´ ì‹¤íŒ¨ëì„ ë•Œì˜ actionì„ dispatchí•œë‹¤.
  - ìµœì¢…ì ìœ¼ë¡œ finallyì—ì„œ `put` effectë¡œ ë¡œê·¸ì¸ ì•¡ì…˜ì´ ì¢…ë£Œë˜ì—ˆìŒì„ ì•Œë ¤ì£¼ëŠ” actionì„ dispatchí•œë‹¤.

### TodoList ê°€ì ¸ì˜¤ê¸°

- `getTodosSaga`ë¥¼ í™œìš©í•´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ í•´ë‹¹ ìœ ì €ì˜ í† ê·¼ì— ë§ì¶° `_id`ì— ë§ëŠ” Todo ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤
  - ê¸°ì¡´ì— firebaseì™€ í™œìš©í• ë•Œì™€ëŠ” ë‹¤ë¥´ê²Œ ì¿ í‚¤ë¥¼ í™œìš©í–ˆê¸° ë•Œë¬¸ì— ë”°ë¡œ userì˜ idë¥¼ ê°€ì ¸ì˜¬ í•„ìš” ì—†ì´ ì €ì¥ëœ ì¿ í‚¤ì— ìœ ì €ì˜ JWTí† í°ì„ í—¤ë”ì— ë‹´ì•„ì„œ ìš”ì²­ì„ í•˜ë©´ëœë‹¤.
  ```ts
  const getDatas = async () => {
    // async awaitê³¼ try catchê°€ í•„ìš”í• ì§€ëŠ” ìƒê° í•´ë´ì•¼ ë ë“¯...
    // ì´ìœ : sagaì—ì„œ ì²˜ë¦¬í•˜ê³  ìˆê¸°ë•Œë¬¸
    try {
      return dispatch(getTodos());
    } catch (e) {
      return e
    }
  }
  useEffect(() => {
    getData();
  }, []);
  ```

- ë¡œê·¸ì¸ í›„ Todoì•±ìœ¼ë¡œ `navigate`ë  ë•Œ ìµœì´ˆ TodoListë¥¼ í•œ ë²ˆ ë§Œ ë°›ì•„ì™€ì„œ ë Œë”ë§ì„ í•˜ê¸° ë•Œë¬¸ì— `useEffect`ë¥¼ í™œìš©í•˜ì˜€ë‹¤.

- TodoList ì¶”ê°€í•˜ê¸°

  - inputì°½ì— todoë¥¼ ì ì€ í›„ í•´ë‹¹ inputì˜ í…ìŠ¤íŠ¸ë¥¼ ë°ì´í„° ë² ì´ìŠ¤ë¡œ `submit`í•œë‹¤.

    ```ts
    const onSubmit = async (e: React.FormEvent<HTMLFormElement>) => {
      try {
        e.preventDefault();
        if (todoValue.length === 0) return alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
        dispatch(createTodo({ text: todoValue, isCompleted: false, createdAt: new Date().toISOString() }))
        // createdAteì— toISOStringì„ ë¶™ì¸ ì´ìœ ëŠ” ì„œë²„ì—ì„œ ë°›ì„ ë•Œ Dateí˜•ì‹ìœ¼ë¡œ ë°›ê¸´í•˜ì§€ë§Œ String íƒ€ì…ìœ¼ë¡œ ë“¤ì–´ê°€ì¤˜ì•¼í•˜ê¸° ë•Œë¬¸ì„
      } catch (err) {
        return err
      } finally {
        dispatch(changeInput(''));
      }
    };
    ```

    - submití•  ë•Œ createTodoë¥¼ disaptchí•´ì„œ payloadë¡œ text, isCompleted, createdAtì„ ë„£ì–´ì¤€ë‹¤.

### TodoList ìˆ˜ì •í•˜ê¸°

- ìˆ˜ì •í•˜ê¸°ëŠ” `updateTextTodo`ì™€ `updateCheckTodo`ì•¡ì…˜ì„ í™œìš©í•´ì„œ Todoì˜ ìˆ˜ì •ê³¼ ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²˜ë¦¬ë¥¼ êµ¬í˜„í•˜ì˜€ë‹¤.

  ```ts
  // Todoë¥¼ ìˆ˜ì •í•˜ëŠ” í•¨ìˆ˜
  const editSubmit = async (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    try {
      dispatch(updateTextTodo({ _id, text: editTodoValue }));
    } catch (e) {
      return e;
    } finally {
      dispatch(changeEditInput(''));
    }
    setIsEdit(false);
    
  };

  // Todoì˜ ì™„ë£Œ/ë¯¸ì™„ë£Œë¥¼ ìˆ˜ì •í•˜ëŠ” í•¨ìˆ˜
  const getDoneTodo = async () => {
    try {
      dispatch(updateCheckTodo({ _id, isComplted: !isComplted }));
    } catch (e) {
      return e;
    }
  };
  ```

- ë¶€ê°€ì ìœ¼ë¡œ ìˆ˜ì •í•  ë•Œ ìˆ˜ì •ì•„ì´ì½˜ì„ í´ë¦­í•˜ë©´ ìˆ˜ì •í•˜ëŠ” inputìœ¼ë¡œ focusë˜ë„ë¡ ê°™ì´ êµ¬í˜„í•˜ì˜€ë‹¤.
  ```ts
  const editRef = useRef<HTMLInputElement | null>(null); // refë¥¼ ìˆ˜ì •ë²„íŠ¼ í´ë¦­ì‹œ inputì°½ì— propsë¡œ ì „ë‹¬
  useLayoutEffect(() => {
    // useLayoutEffectë¥¼ í™œìš©í•´ í•´ë‹¹ inputìœ¼ë¡œ focusë˜ë„ë¡ ì²˜ë¦¬
    editRef.current !== null && editRef.current.focus();
  });
  ```

### TodoList ì‚­ì œí•˜ê¸°

- ì‚­ì œëŠ” ë§¤ìš° ê°„ë‹¨í•˜ê²Œ `deleteTodo`ì•¡ì…˜ì„ í™œìš©í•´ì„œ ì‚­ì œë²„íŠ¼ í´ë¦­ ì‹œ í•´ë‹¹ idë¥¼ ê°€ì§„ Todoë°ì´í„°ë¥¼ ì‚­ì œí•˜ëŠ” ê²ƒìœ¼ë¡œ êµ¬í˜„í–ˆë‹¤.
  ```ts
  const deleteTodo = async () => {
    try {
      dispatch(deleteTodo({ _id }));
    } catch (e) {
      return e;
    }
  };
  ```

### Realtime DBì—ì„œ FireStore DBë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜(23. 2. 11(í† ))ì™„ë£Œ

- FireStoreëŠ” ì¿¼ë¦¬ ì¤‘ì‹¬ì˜ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ê°œì¸ì ìœ¼ë¡œ Realtimeë³´ë‹¤ FireStore ë°ì´í„°ë² ì´ìŠ¤ê°€ ì¸ë±ì‹±ë¶€í„° ë°ì´í„° ê´€ë¦¬ ì¸¡ë©´ì— ìˆì–´ ë” íš¨ìœ¨ì ì´ë¼ê³  íŒë‹¨ë˜ì–´ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì§„í–‰í–ˆë‹¤.
  - ë©”ì„œë“œ ë“¤ì€ Realtimeê³¼ í° ì°¨ì´ëŠ” ì—†ìœ¼ë©° ì¤‘ì ì ìœ¼ë¡œ ë³€ê²½ëœ ì‚¬í•­ì€ realtimeì€ refë¼ëŠ” ë©”ì„œë“œë¥¼ í™œìš©í•´ì„œ ë°ì´í„° ë² ì´ìŠ¤ì— ì ‘ê·¼í–ˆì§€ë§Œ firestoreëŠ” ì»¬ë ‰ì…˜ì„ ê¸°ì¤€ìœ¼ë¡œ ì ‘ê·¼ì„ í•œë‹¤ëŠ” ì°¨ì´ê°€ ìˆë‹¤.
  - ì´ˆê¸° ë°ì´í„°ë¥¼ todosë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ìˆì–´ ì‚¬ìš©í•œ ë©”ì„œë“œëŠ” queryì™€ onSnapshotì´ë¼ëŠ” ë©”ì„œë“œë¡œ getì„ ì‚¬ìš©í•˜ë˜ realtimeê³¼ì˜ ì°¨ì´ê°€ ìˆë‹¤.
  - ë°ì´í„°ì˜ ì¶”ê°€ì— ìˆì–´ì„œëŠ” realtimeì€ set, firestoreëŠ” addDoc í˜¹ì€ setDocì„ ì‚¬ìš©
  - ì‚­ì œëŠ” realtimeì—ì„œëŠ” remove, firestoreëŠ” deleteDoc
  - ìˆ˜ì •ì€ realtimeì—ì„  update, firestoreëŠ” updateDocìœ¼ë¡œ í™œìš©ëœë‹¤.

### Firebaseì—ì„œ ìì²´ ê°œë°œí•œ ì„œë²„ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜(23. 4. 16(ì¼))ì™„ë£Œ

- ê¸°ì¡´ì— í˜„ì¬ ì§„í–‰ì¤‘ì¸ í”„ë¡ íŠ¸ì—”ë“œ í”„ë¡œì íŠ¸ëŠ” vercelë¡œ ë°°í¬ë¥¼ ì™„ë£Œí–ˆì—ˆê³  ê±°ê¸°ì— Firebaseë¥¼ ë¶™ì—¬ì„œ Todoë¥¼ ê´€ë¦¬í•˜ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰
- ìµœê·¼ì— ì„œë²„ë¥¼ ì§ì ‘ ê°œë°œí•´ë³´ì í•˜ëŠ” ìƒê°ìœ¼ë¡œ ê°œë°œì„ ì§„í–‰í–ˆì—ˆê³  1ì£¼ì¼ ì •ë„ ê¸°ê°„ì— ì„œë²„ê°œë°œì„ ì™„ë£Œ í•˜ê³  AWS EC2ì™€ Dockerë¥¼ í™œìš©í•´ ë°°í¬ë¥¼ ì™„ë£Œí–ˆì—ˆìœ¼ë©° ê°€ë¹„ì•„ì—ì„œ ë„ë©”ì¸ì„ êµ¬ì…í•´ ì„œë²„ë¡œ httpsë¡œ ë°”ê¾¸ê¸° ìœ„í•´ Route53ì„ í™œìš©í•´ ë„ë©”ì¸ê¹Œì§€ ì…‹íŒ…ì„ ë§ˆì¹œ ìƒíƒœ
- í•˜ì§€ë§Œ ë°°í¬í•œì§€ ì–¼ë§ˆ ë˜ì§€ ì•Šì•„ì„œ AWSì—ì„œ ê³¼ê¸ˆ ì²­êµ¬ ê³ ì§€ì„œê°€ ë‚ ì•„ì™€ ìš”ê¸ˆ ë¬¸ì œ ë•Œë¬¸ì— ë°°í¬ëœ ì„œë²„ë¥¼ ë‚´ë¦¼
- í”„ë ˆì„ì›Œí¬ëŠ” `Koa`ë¥¼ DBëŠ” `MongoDB`ë¥¼ ì‚¬ìš©í–ˆì—ˆìœ¼ë©° ìì„¸í•œ ì„œë²„ í”„ë¡œì íŠ¸ëŠ” ì•„ë˜ github repoë¥¼ ì°¸ì¡°
  - ë§í¬: [https://github.com/hjpark625/todo-backend](https://github.com/hjpark625/todo-backend)