# Todos APP with Firebase

## ğŸ’¡ í”„ë¡œì íŠ¸ ì •ë³´

1. í”„ë¡œì íŠ¸ ëª… : Todos App with Firebase
2. í”„ë¡œì íŠ¸ ê¸°ê°„ : 2022. 9. 12. ~ 2022. 9. 19.
3. í”„ë¡œì íŠ¸ ì°¸ê°€ ì¸ì›: ë‹¨ë…í”„ë¡œì íŠ¸

<br />

---

<br/>

## ğŸŒˆ ì‹¤í–‰ ë°©ë²•

    $ git clone https://github.com/hjpark625/new-todos.git
    $ cd new-todos
    $ yarn install
    $ yarn start

<br />

---

## â­ ë°°í¬ ë§í¬

<br/>

> http://new-todos.vercel.app/

<br/>

---

## ğŸ” ë°°í¬ í…ŒìŠ¤íŠ¸ ê³„ì •

<br />

> id(email): tester@naver.com  
> password: 1q2w3e4r!

<br/>

---

## ğŸ“š ê¸°ìˆ ìŠ¤íƒ

<br />

![react](https://img.shields.io/badge/react-18.2.0-61DAFB?logo=react)
![typescript](https://img.shields.io/badge/typescript-4.8.3-3178C6?logo=typescript)
![styledComponents](https://img.shields.io/badge/styled--components-5.3.5-DB7093?logo=styledcomponents)
![react-router-dom](https://img.shields.io/badge/react--router--dom-6.3.0-blue?logo=react-router)  
![firebase](https://img.shields.io/badge/firebase-9.9.4-E1C537?logo=firebase)
![redux](https://img.shields.io/badge/redux-4.2.0-pink?logo=redux)
![react-redux](https://img.shields.io/badge/react--redux-8.0.2-pink?logo=redux)

- **ì„ ì • ì´ìœ **

  - _TypeScript_
    - ì •ì  íƒ€ì… ì§€ì›í•˜ë¯€ë¡œ ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œ ì˜¤ë¥˜ë¥¼ ì‚¬ì „ì— í¬ì°©í•  ìˆ˜ ìˆìœ¼ë©° ì´ë¥¼ í†µí•´ ë¯¸ë¦¬ ë””ë²„ê¹…ì´ ê°€ëŠ¥í•¨
  - _Styled-Components_
    - CSS-in-JSëŠ” ì§§ì€ ê¸¸ì´ì˜ ìœ ë‹ˆí¬í•œ í´ë˜ìŠ¤ë¥¼ ìë™ì ìœ¼ë¡œ ìƒì„±í•˜ê¸°ì— ì½”ë“œ ê²½ëŸ‰í™”ì— íš¨ê³¼ì 
    - ì»´í¬ë„ŒíŠ¸ ê¸°ë°˜ ê°œë°œ ë°©ë²•ì— ì í•©í•˜ê³  ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” CSS-in-JS ë¼ì´ë¸ŒëŸ¬ë¦¬
    - JS ìƒìˆ˜ì™€ í•¨ìˆ˜ë¥¼ ì‰½ê²Œ ê³µìœ í•˜ì—¬ propsë¥¼ í™œìš©í•œ ì¡°ê±´ë¶€ ë Œë”ë§ì— ìš©ì´
    - ì»´í¬ë„ŒíŠ¸í™”í•˜ì—¬ ì¬í™œìš© ê°€ëŠ¥
  - _Firebase_
    - ë°±ì—”ë“œì˜ ë¶€ì¬ë¡œ ì¸í•œ Todoë¦¬ìŠ¤íŠ¸ë¥¼ ì €ì¥í•  ë°ì´í„° êµ¬ì¶•ì— í™œìš©
    - email, passwordë¡œê·¸ì¸ APIë¥¼ ì§€ì›
    - DBë¥¼ ìì²´ì ìœ¼ë¡œ ë˜í•œ ììœ ë¡­ê²Œ êµ¬ì¶•í•  ìˆ˜ ìˆì–´ ê°œì¸ í”„ë¡œì íŠ¸ì— í™œìš©í•˜ê¸°ì— ìš©ì´
  - _React-Router-Dom_
    - Reactì˜ SPA(Single Page Application)íŠ¹ì„±ìƒ í•˜ë‚˜ì˜ í˜ì´ì§€(HTML)ì—ì„œ ëª¨ë“  ë Œë”ë§ì´ ì´ë£¨ì–´ì§
    - Reactì˜ ì´ëŸ¬í•œ ê°•ì ì„ í™œìš©í•˜ê¸° ìœ„í•´ í˜ì´ì§€ì˜ ë¡œë”©ì—†ì´ í˜ì´ì§€ì— í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§ í•˜ê¸° ìœ„í•´ ì‚¬ìš©
  - _Redux_ / _React-Redux_
    - ì „ì—­ ìƒíƒœ ê´€ë¦¬í•˜ëŠ”ë° í™œìš©
    - ì „ì—­ ìƒíƒœ ê´€ë¦¬ì— ìˆì–´ props drillingì„ í”¼í•  ìˆ˜ ìˆìŒê³¼ ë™ì‹œì— ì„±ëŠ¥ ìµœì í™”ì— ìš©ì´

<br />

---

## ğŸ“ í´ë” êµ¬ì¡°

    root
    |-- tsconfig.json
    |-- README.md
    |-- package.json
    |-- yarn.lock
    |-- .gitignore
    |-- public
    |   |-- index.html
    |-- src
        |-- compoenents
           |-- auth
               |-- styles
           |-- Todos
           |-- types
        |-- pages
           |-- Main
           |-- Todo
        |-- modules
        |-- styles
        |-- Router.tsx
        |-- index.tsx
        |-- react-app-env.d.ts
        |-- firebase.ts

---

## ğŸ“ êµ¬í˜„ ê¸°ëŠ¥

### Firebase íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„ ë° DBêµ¬ì¶•

- íšŒì›ê°€ì…
  - íšŒì›ê°€ì…ì€ `firebase`ì—ì„œ `createUserWithEmailAndPassword`ë©”ì†Œë“œë¥¼ ì œê³µí•´ì¤€ë‹¤.
  - ìœ„ì˜ ë©”ì†Œë“œë¥¼ í™œìš©í•´ì„œ `firebase.ts`ì— `register`í•¨ìˆ˜ë¥¼ ì œì‘í•´ì£¼ì—ˆë‹¤.
    ```ts
    export const register = (email: string, password: string) => {
      return createUserWithEmailAndPassword(auth, email, password);
    };
    ```
- ë¡œê·¸ì¸
  - ë¡œê·¸ì¸ì€ `firebase`ì—ì„œ `signInWithEmailAndPassword`ë©”ì†Œë“œë¥¼ ì œê³µí•´ì¤€ë‹¤.
  - ìœ„ì˜ ë©”ì†Œë“œë¥¼ í™œìš©í•´ì„œ ë§ˆì°¬ê°€ì§€ë¡œ `firebase.ts`ì— `login`í•¨ìˆ˜ë¥¼ ì œì‘í–ˆë‹¤.
    ```ts
    export const login = (email: string, password: string) => {
      return signInWithEmailAndPassword(auth, email, password);
    };
    ```
- íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ í•  ë•Œ `firebase`ì—ì„œ ì„±ê³µí–ˆì„ ë•Œì˜ ì‘ë‹µì„ `Realtime Database`ì— `set`ë©”ì†Œë“œë¥¼ í™œìš©í•´ ìœ ì €ë°ì´í„°ì˜ `email`ê³¼ `uid`ë¥¼ ì €ì¥í–ˆìœ¼ë©° ì¶”í›„ Todosë¦¬ìŠ¤íŠ¸ì— ë¡œê·¸ì¸ í–ˆì„ ë•Œ ê° ê³ ìœ ë³„ë¡œ Todoë¥¼ ê°–ê²Œ í•˜ê¸° ìœ„í•´ `uid`ë¥¼ í™œìš©í•˜ì—¬ ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ ê°™ì´ êµ¬í˜„í•˜ì˜€ë‹¤.
- DBëŠ” `Realtime Database`ë¥¼ í™œìš©í•˜ì—¬ êµ¬ì¶•ì„ í–ˆë‹¤.

  - `firebase.ts`ì—ì„œ `getDatabase`ë¥¼ í™œìš©í•´ì„œ dbë¼ëŠ” ì´ë¦„ì˜ ë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´ ì£¼ì—ˆê³  ê·¸ dbë¥¼ í™œìš©í•´ì„œ CRUDì— í™œìš©í•˜ì˜€ë‹¤.
  - dbë¥¼ í™œìš©í•˜ê¸° ìœ„í•´ì„œëŠ” `ref`ë¼ëŠ” ë©”ì†Œë“œë¥¼ ê°™ì´ í™œìš©í•´ì„œ ë°ì´í„°ê°€ ì…ë ¥ë˜ê³  ìš”ì²­ë˜ì–´ì•¼ í•  dbì˜ urlì„ ì§€ì •í•´ì¤˜ì•¼ í•œë‹¤.

    ```ts
    /* AuthForm.tsx - handleSubmit */
    if (type === 'register') {
    await register(userInfo.register.email, userInfo.register.password)
      .then(res => {
        set(ref(db, `users/${res.user.uid}`), { // setë©”ì†Œë“œì— refë¥¼ ë‹¬ì•„ì¤€ë‹¤.(ë°ì´í„° ë² ì´ìŠ¤ë¥¼ ì°¾ì•„ê°€ê²Œ í•˜ê¸° ìœ„í•œ ëª©ì )
          id: res.user.uid,
          email: res.user.email,
        });
        alert('íšŒì›ê°€ì… ì„±ê³µ!');
        navigate('/todo');
      })
      /* ... */
    ```

### TodoList ê°€ì ¸ì˜¤ê¸°

- `get`ë©”ì†Œë“œë¥¼ í™œìš©í•´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ í•´ë‹¹ ìœ ì € `uid`ì— ë§ëŠ” Todo ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤

  ```ts
  const token = localStorage.getItem('uid'); // ë¡œê·¸ì¸ ì‹œ ìœ ì €ì˜ uidë¥¼ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•œ í›„ í™œìš©í•˜ëŠ” ìƒíƒœ

  useEffect(() => {
    const todoRef = ref(db, `/todos/${token}`);
    onValue(todoRef, res => {
      setTodos(res.val());
    });
  }, []);
  ```

- ë¡œê·¸ì¸ í›„ Todoì•±ìœ¼ë¡œ `navigate`ë  ë•Œ ìµœì´ˆ TodoListë¥¼ í•œ ë²ˆ ë§Œ ë°›ì•„ì™€ì„œ ë Œë”ë§ì„ í•˜ê¸° ë•Œë¬¸ì— `useEffect`ë¥¼ í™œìš©í•˜ì˜€ë‹¤.

- TodoList ì¶”ê°€í•˜ê¸°

  - inputì°½ì— todoë¥¼ ì ì€ í›„ í•´ë‹¹ inputì˜ í…ìŠ¤íŠ¸ë¥¼ ë°ì´í„° ë² ì´ìŠ¤ë¡œ `submit`í•œë‹¤.

    ```ts
    const onSubmit = async (e: React.FormEvent<HTMLFormElement>) => {
      try {
        const postDB = ref(db, `/todos/${token}/${todoId}`);
        e.preventDefault();
        setTodoId(prev => prev + 1);
        await set(postDB, {
          id: todoId,
          text: todoValue,
          isCompleted: false,
        });
      } catch (err) {
        alert('ì‘ì„±ì— ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.');
        console.error(err);
      } finally {
        dispatch(changeInput(''));
      }
    };
    ```

    - submití•  ë•Œë„ ë§ˆì°¬ê°€ì§€ë¡œ `set`ë©”ì†Œë“œì™€ `ref`ë©”ì†Œë“œë¥¼ í™œìš©í•´ ë°ì´í„°ë² ì´ìŠ¤ì— í•´ë‹¹ ìœ ì € `uid`ì£¼ì†Œì˜ ë°ì´í„°ë² ì´ìŠ¤ì— `POST`ë¥¼ í•œë‹¤.

### TodoList ìˆ˜ì •í•˜ê¸°

- ìˆ˜ì •í•˜ê¸°ëŠ” `update`ë©”ì†Œë“œë¥¼ í™œìš©í•´ì„œ Todoì˜ ìˆ˜ì •ê³¼ ì™„ë£Œ/ë¯¸ì™„ë£Œ ì²˜ë¦¬ë¥¼ êµ¬í˜„í•˜ì˜€ë‹¤.

  ```ts
  // Todoë¥¼ ìˆ˜ì •í•˜ëŠ” í•¨ìˆ˜
  const editSubmit = async (e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    const editRef = ref(db, `todos/${token}/${id}`);
    await update(editRef, {
      text: editTodo,
    }).catch(err => {
      alert('ìˆ˜ì •ì— ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.');
      console.error(err);
    });
    setIsEdit(false);
  };

  // Todoì˜ ì™„ë£Œ/ë¯¸ì™„ë£Œë¥¼ ìˆ˜ì •í•˜ëŠ” í•¨ìˆ˜
  const getDoneTodo = async () => {
    const doneRef = ref(db, `todos/${token}/${id}`);
    setIsDone(!isDone);
    await update(doneRef, {
      isCompleted: isDone,
    }).catch(err => {
      alert('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      console.error(err);
    });
  };
  ```

- ë¶€ê°€ì ìœ¼ë¡œ ìˆ˜ì •í•  ë•Œ ìˆ˜ì •ì•„ì´ì½˜ì„ í´ë¦­í•˜ë©´ ìˆ˜ì •í•˜ëŠ” inputìœ¼ë¡œ focusë˜ë„ë¡ ê°™ì´ êµ¬í˜„í•˜ì˜€ë‹¤.
  ```ts
  const editRef = useRef<HTMLInputElement | null>(null); // refë¥¼ ìˆ˜ì •ë²„íŠ¼ í´ë¦­ì‹œ inputì°½ì— propsë¡œ ì „ë‹¬
  useLayoutEffect(() => {
    // useLayoutEffectë¥¼ í™œìš©í•´ í•´ë‹¹ inputìœ¼ë¡œ focusë˜ë„ë¡ ì²˜ë¦¬
    editRef.current !== null && editRef.current.focus();
  });
  ```

### TodoList ì‚­ì œí•˜ê¸°

- ì‚­ì œëŠ” ë§¤ìš° ê°„ë‹¨í•˜ê²Œ `remove`ë©”ì†Œë“œë¥¼ í™œìš©í•´ì„œ ì‚­ì œë²„íŠ¼ í´ë¦­ ì‹œ í•´ë‹¹ idë¥¼ ê°€ì§„ Todoë°ì´í„°ë¥¼ ì‚­ì œí•˜ëŠ” ê²ƒìœ¼ë¡œ êµ¬í˜„í–ˆë‹¤.
  ```ts
  const deleteTodo = async () => {
    const deleteRef = ref(db, `todos/${token}/${id}`);
    remove(deleteRef);
  };
  ```

### Realtime DBì—ì„œ FireStore DBë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜(23. 2. 11(í† ) ì™„ë£Œ))

- FireStoreëŠ” ì¿¼ë¦¬ ì¤‘ì‹¬ì˜ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ê°œì¸ì ìœ¼ë¡œ Realtimeë³´ë‹¤ FireStore ë°ì´í„°ë² ì´ìŠ¤ê°€ ì¸ë±ì‹±ë¶€í„° ë°ì´í„° ê´€ë¦¬ ì¸¡ë©´ì— ìˆì–´ ë” íš¨ìœ¨ì ì´ë¼ê³  íŒë‹¨ë˜ì–´ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì§„í–‰í–ˆë‹¤.
  - ë©”ì„œë“œ ë“¤ì€ Realtimeê³¼ í° ì°¨ì´ëŠ” ì—†ìœ¼ë©° ì¤‘ì ì ìœ¼ë¡œ ë³€ê²½ëœ ì‚¬í•­ì€ realtimeì€ refë¼ëŠ” ë©”ì„œë“œë¥¼ í™œìš©í•´ì„œ ë°ì´í„° ë² ì´ìŠ¤ì— ì ‘ê·¼í–ˆì§€ë§Œ firestoreëŠ” ì»¬ë ‰ì…˜ì„ ê¸°ì¤€ìœ¼ë¡œ ì ‘ê·¼ì„ í•œë‹¤ëŠ” ì°¨ì´ê°€ ìˆë‹¤.
  - ì´ˆê¸° ë°ì´í„°ë¥¼ todosë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ìˆì–´ ì‚¬ìš©í•œ ë©”ì„œë“œëŠ” queryì™€ onSnapshotì´ë¼ëŠ” ë©”ì„œë“œë¡œ getì„ ì‚¬ìš©í•˜ë˜ realtimeê³¼ì˜ ì°¨ì´ê°€ ìˆë‹¤.
  - ë°ì´í„°ì˜ ì¶”ê°€ì— ìˆì–´ì„œëŠ” realtimeì€ set, firestoreëŠ” addDoc í˜¹ì€ setDocì„ ì‚¬ìš©
  - ì‚­ì œëŠ” realtimeì—ì„œëŠ” remove, firestoreëŠ” deleteDoc
  - ìˆ˜ì •ì€ realtimeì—ì„  update, firestoreëŠ” updateDocìœ¼ë¡œ í™œìš©ëœë‹¤.
